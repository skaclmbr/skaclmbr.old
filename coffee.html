<html>
	<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=9">
	<title>how much will my coffee cost in retirement?</title>
	<!-- Load charts js -->
	<link href='http://fonts.googleapis.com/css?family=Lato:400,700' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="stylesheets/styles.css">
	<link rel="stylesheet" href="stylesheets/pygment_trac.css">
	<link rel="stylesheet" href="stylesheets/coffee.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<!-- 	<script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script> -->
	<script src="javascripts/respond.js"></script>
	<script src="javascripts/Chart.js"></script>
<!-- 	 <script>
		$(function() {
		$( "#viceList" ).selectmenu();
		});
	</script>
	<style>
		fieldset {
		border: 0;
		}
		label {
		display: block;
		margin: 30px 0 0 0;
		}
		select {
		width: 200px;
		}
		.overflow {
		height: 200px;
		}
	</style>
 -->	
	<script>
		var returnRate = 0.04 //4% return rate
		var currVice = "coffee"
		var yr2Retire = 30
		
		var vices = {
			test:{
				amtwk: [1,2,3,4,5],
				cost: 1000
				},
			coffee:{
				amtwk: [1,2,3,4,5],
				cost: 5
				},
			soda:{
				amtwk: [1,2,3,4,5,6,7,8,9,10],
				cost: 1.5
				}
			};
		
		$(document).ready(function(){
		
			<!-- console.log($("#viceList")); -->
			var ctx = $("#retireChart").get(0).getContext("2d");
			<!-- console.log(ctx); -->
			$("#viceList").change(function(){
				console.log(this);
				currVice = this.value;
				buildTable(ctx);
			});
			<!-- buildTable(ctx); -->
			});
		
		function calculateCost(cost,amounts,yearstoRetire) {
			//return array of data
			//cost = cost of item
			//amounts = array of amount of item to consume/week
			//yearstoRetire = duh.
			
			var arrayLength = amounts.length;
			var data = [];
			for (var i = 0; i<arrayLength;i++) {
				//apply formula
				var t = Math.pow(1 + returnRate ,yearstoRetire )
				data.push(cost*amounts[i]*((t-1)/returnRate));
			};
			
			console.log(data);
			return data;
			};
		
		function retrieveData(vice, yearstoRetire) {
			//embed formula here to calculate data points for chart
			console.log(calculateCost(vices[currVice]["cost"],vices[currVice]["amtwk"],yr2Retire));
			var data = {
				labels: vices[currVice]["amtwk"],
				datasets: [
					{
						label: "My First dataset",
						fillColor: "rgba(220,220,220,0.2)",
						strokeColor: "rgba(220,220,220,1)",
						pointColor: "rgba(220,220,220,1)",
						pointStrokeColor: "#fff",
						pointHighlightFill: "#fff",
						pointHighlightStroke: "rgba(220,220,220,1)",
						data: calculateCost(vices[currVice]["cost"],vices[currVice]["amtwk"],yr2Retire)
					}
				]
			};
			return data; //return data for chart
			};
		function buildTable(ctx){
			console.log("runs!");
			// This will get the first returned node in the jQuery collection.

			
			var options ={

				///Boolean - Whether grid lines are shown across the chart
				scaleShowGridLines : true,

				//String - Colour of the grid lines
				scaleGridLineColor : "rgba(0,0,0,.05)",

				//Number - Width of the grid lines
				scaleGridLineWidth : 1,

				//Boolean - Whether the line is curved between points
				bezierCurve : true,

				//Number - Tension of the bezier curve between points
				bezierCurveTension : 0.4,

				//Boolean - Whether to show a dot for each point
				pointDot : true,

				//Number - Radius of each point dot in pixels
				pointDotRadius : 4,

				//Number - Pixel width of point dot stroke
				pointDotStrokeWidth : 1,

				//Number - amount extra to add to the radius to cater for hit detection outside the drawn point
				pointHitDetectionRadius : 20,

				//Boolean - Whether to show a stroke for datasets
				datasetStroke : true,

				//Number - Pixel width of dataset stroke
				datasetStrokeWidth : 2,

				//Boolean - Whether to fill the dataset with a colour
				datasetFill : true,

				//String - A legend template
				legendTemplate : "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<datasets.length; i++){%><li><span style=\"background-color:<%=datasets[i].lineColor%>\"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>"

			};


			var myLineChart = new Chart(ctx).Line(retrieveData(1,2), options);
			};
	</script>
</head>


<body>
<form action="#"><fieldset>
<h2>How Much Will <select name="vices" id="viceList"><option> </option><option>coffee</option><option>soda</option></select> Affect My Retirement in 30 years?</h2>
</fieldset></form>
<canvas id="retireChart" width="800" height="400""></canvas>

</body>

</html>